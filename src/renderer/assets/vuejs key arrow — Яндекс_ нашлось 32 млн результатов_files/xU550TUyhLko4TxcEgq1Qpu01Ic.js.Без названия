_borschik("_pnu-")&&(window.MOUSE_TRACKING=function(){function t(t){return function(){try{return t.apply(this,arguments)}catch(t){}}}function e(e,n){return window.setTimeout(t(e),n)}function n(e,n){return window.setInterval(t(e),n)}var i=$(window),s=$(document),r=$.extend({ATTENTION_MIN_DURATION:1e3,ATTENTION_MAX_INTERRUPT:6e4,VIEWPORT_CHANGE_TIMEOUT:500,REQID_CHECK_INTERVAL:1e3,ALIVE_PACKET_ENABLED:!0,ALIVE_PACKET_INTERVAL:3e3,SENDER_MAX_REQUEST_COUNT:60,SENDER_MAX_PACKET_SIZE:1e3,SENDER_REQUEST_INTERVAL:1e4,SENDER_REQUEST_CACHE_TIMEOUT:3e4,COORDINATES_SCALE:1,MOUSEMOVE_LOG:1},window.MOUSE_TRACKING_SETTINGS||{});i.one("load",t(function(){function o(){return(new Date).getTime()}function u(){return Math.round((o()-f)/d)}function a(t,e){t.push(255&e)}function h(t,e){for(e=Math.max(0,0|e);e>127;)t.push(127&e|128),e>>=7;t.push(e)}function c(t){try{return window.BEM&&BEM.blocks["i-global"].param(t)}catch(t){return""}}function _(t){return Math.floor(t*r.COORDINATES_SCALE)}function E(t){var e=[];return a(e,t),h(e,u()),e}var d=50,l=10,f=o(),p=101,m=102,g=103,T=104,S=105,A=106,I=107,b={attention:function(t,e,n){var i=[];return a(i,m),h(i,t),h(i,e),h(i,n),i},serpItem:function(t,e,n){t=$(t);var i=[],s=t.offset();return h(i,e),h(i,n),h(i,_(s.left)),h(i,_(s.top)),h(i,_(t.outerWidth())),h(i,_(t.outerHeight())),i},serpItems:function(t,e,n){var i=[];a(i,p),h(i,u()),h(i,t),h(i,e),h(i,n.length);for(var s=0,r=n.length;s<r;s++)$.merge(i,b.serpItem(n[s][0],n[s][1],n[s][2]));return i},viewport:function(t){var e=[];return a(e,g),h(e,u()),h(e,_(t[0])),h(e,_(t[1])),h(e,_(t[2])),h(e,_(t[3])),e},mouseClick:function(t,e,n,i){var s=[];return a(s,T),h(s,u()),h(s,_(t)),h(s,_(e)),h(s,n),h(s,i),s},alive:function(){return E(S)},windowFocus:function(){return E(I)},windowBlur:function(){return E(A)}},v=function(t){$.extend(this,t||{}),this._active=!0,this._timeLast=this.timeStart,this.mouseMove(this.serpItem,this.timeStart)};v.prototype={grabberDom:null,sender:null,serpItem:null,timeStart:0,mouseMove:function(t,e){return this.serpItem&&t===this.serpItem&&(e-this._timeLast)*d<r.ATTENTION_MAX_INTERRUPT?(this._timeLast=e,!0):(this.close(),!1)},close:function(){if(this._active&&(this._active=!1,"undefined"!=typeof this._timeLast&&"undefined"!=typeof this.timeStart&&this.serpItem&&this.sender)){var t=this._timeLast-this.timeStart;if(t*d>r.ATTENTION_MIN_DURATION){var e=this.grabberDom.elements.index(this.serpItem);e>-1&&this.sender.enqueue(b.attention,[this.timeStart,t,e])}}}};var R=function(t){this.sender=t,this._pageTimestamp=o(),this.updateDom(),n(this.updateDom.bind(this),r.REQID_CHECK_INTERVAL)};R.prototype={reqid:"",updateDom:$.throttle(function(){var t=c("reqid");this.reqid!==t&&(this.reqid=t,this._grabDOM(),this.grabViewport())}),_grabDOM:$.throttle(function(){this.elements=$("[data-cid]");var t=this.elements.toArray().map(function(t){return t=$(t),[t,parseInt(t.attr("data-cid"))+1,0]},this);t.length>0&&this.sender.enqueue(b.serpItems,[d,this._pageTimestamp,t])},l),grabViewport:$.throttle(function(){var t=[i.scrollLeft(),i.scrollTop(),i.width(),i.height()];this.sender.enqueue(b.viewport,[t])},l)};var w=function(){this._ls=null;try{this._ls=localStorage}catch(t){}};w.prototype={set:function(t,e){if(this.isEnabled())try{!e||$.isArray(e)&&!e.length?this.remove(t):this._ls.setItem(this._getLsKey(t),JSON.stringify(e))}catch(t){}},get:function(t){if(this.isEnabled())try{return JSON.parse(this._ls.getItem(this._getLsKey(t)))}catch(t){}return null},remove:function(t){if(this.isEnabled())try{this._ls.removeItem(this._getLsKey(t))}catch(t){}},isEnabled:function(){return this._ls&&"object"==typeof this._ls&&"object"==typeof JSON},_getLsKey:function(t){return"_mt__"+t}};var N={abc:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%-_",encode:function(t){for(var e,n=N.abc,i=t.length,s=[],r=i-i%3,o=0;o<r;o+=3)e=(t[o]<<16)+(t[o+1]<<8)+t[o+2],s.push(n[e>>18&63],n[e>>12&63],n[e>>6&63],n[63&e]);switch(i-r){case 1:e=t[r]<<4,s.push(n[e>>6&63],n[63&e],n[64],n[64]);break;case 2:e=(t[r]<<10)+(t[r+1]<<2),s.push(n[e>>12&63],n[e>>6&63],n[63&e],n[64])}return s.join("")}},M=function(t){$.extend(this,t||{}),this._started=!1,this._countRequestSent=this.countRequestSentInit||0,this._packetQueue=this.packetQueueInit||[]};M.prototype={requestsTimeout:r.SENDER_REQUEST_INTERVAL,reqid:"",countRequestSentInit:0,packetQueueInit:null,enqueue:function(t,e){if(this.reqid&&this.hasQuota()&&this._packetQueue.length<r.SENDER_MAX_PACKET_SIZE){var n=t.apply(this,e);if(n)return $.merge(this._packetQueue,n),this._dumpToStorage(),this.start(),!0}return!1},flush:function(){if(this.reqid){var t=this._packetQueue.slice(0,r.SENDER_MAX_PACKET_SIZE),e=N.encode(t);this._sendRedir(this.reqid,"690.491.59","-no="+(this._countRequestSent+1)+",-blob="+e),this._packetQueue=[],this._dumpToStorage(),this._countRequestSent++}},send:function(t,e){var n=new Image;n.onload=e||$.noop,n.src=t},start:function(){if(!this._started){this._started=!0;var t=this;e(function(){t.flush(),t._started=!1,t.hasQuota()&&t._packetQueue.length>0&&t.start()},this.requestsTimeout)}},hasQuota:function(){return this._countRequestSent<r.SENDER_MAX_REQUEST_COUNT},_sendRedir:function(t,e,n){var i=c("click-host");if(t&&i){var s=i+"/click/reqid="+t+"/path="+e+(n?"/vars="+n:"")+"/*"+(c("retpath")||"http://yandex.ru/");this.send(s)}},_dumpToStorage:$.throttle(function(){if(this.storage&&this.storage.isEnabled()){var t=this.storage.get("data")||{};if(this._packetQueue.length>0){var e=this._packetQueue.slice(0,r.SENDER_MAX_PACKET_SIZE);t[this.reqid]=[e,o(),this._countRequestSent]}else delete t[this.reqid];this.storage.set("data",t)}},l)};var q=function(){this._senders={},this.storage=new w,this.sendAllFromStorage(),e(this.sendAllFromStorage.bind(this),r.SENDER_REQUEST_CACHE_TIMEOUT)};q.prototype={enqueue:function(t,e){var n=c("reqid");return!!n&&("object"!=typeof this._senders[n]&&(this._senders[n]=new M({reqid:n,storage:this.storage})),this._senders[n].enqueue(t,e))},sendAllFromStorage:function(){if(this.storage&&this.storage.isEnabled()){var t=this.storage.get("data")||{},e={};this.storage.set("data",{}),$.each(t,function(t,n){if($.isArray(n)){var i=n[0],s=n[1],u=n[2],a=o()-s;if(!(a<0||u<0||u>=r.SENDER_MAX_REQUEST_COUNT||!$.isArray(i)||i.length<1))if(a>r.SENDER_REQUEST_CACHE_TIMEOUT){var h=new M({reqid:t,requestsTimeout:0,countRequestSentInit:u,packetQueueInit:i});h.flush()}else n[0]=i.slice(0,r.SENDER_MAX_PACKET_SIZE),e[t]=n}}),this.storage.set("data",e)}}};var C=function(){this.grabberAttention=null,this.sender=new q,this.grabberDom=new R(this.sender),r.ALIVE_PACKET_ENABLED&&n(function(){this.sender.enqueue(b.alive)}.bind(this),r.ALIVE_PACKET_INTERVAL)};C.prototype={onMouseMove:function(t){var e=$(t).closest(this.grabberDom.elements).first(),n=u();e&&e.length>0?this.grabberAttention&&this.grabberAttention.mouseMove(e[0],n)||(this.grabberAttention=new v({serpItem:e[0],timeStart:n,sender:this.sender,grabberDom:this.grabberDom})):(this.grabberAttention&&this.grabberAttention.close(),this.grabberAttention=null)},onMouseClick:function(t,e,n,i){var s=$(t).closest(this.grabberDom.elements).first(),r=s?this.grabberDom.elements.index(s)+1:0;this.sender.enqueue(b.mouseClick,[e,n,r,i])},onWindowFocus:function(){this.sender.enqueue(b.windowFocus)},onWindowBlur:function(){this.sender.enqueue(b.windowBlur)}};var D=new C;r.MOUSEMOVE_LOG&&s.on("mousemove",$.throttle(t(function(t){D.onMouseMove(t.target)}),l)),s.on("click",t(function(t){D.onMouseClick(t.target,t.pageX,t.pageY,t.which)})),i.on("scroll resize",$.debounce(t(function(){D.grabberDom.grabViewport()}),r.VIEWPORT_CHANGE_TIMEOUT)).on("focus",t(function(){D.onWindowFocus()})).on("blur",t(function(){D.onWindowBlur()}))}))},window.$&&window.BEM?MOUSE_TRACKING():window.Ya&&Ya.define?Ya.define("mouse-tracking",["jquery","BEM"],MOUSE_TRACKING):window.logSerpJsError&&logSerpJsError(new Error("Mouse tracking requires global $ and BEM, or Ya.define")));